{% extends 'base.html.twig' %}

{% block headerTitle %}Supply Chain Jobs{% endblock %}

{% block breadcrumbs %}
    <li class="active"><span>Supply Chain Jobs</span></li>
{% endblock %}

{% block body %}
    <h2>Supply Chain Job list</h2>
    <div id="table-listing">
        <div class="table-responsive table-scrollable">
            <table class="table table-bordered table-striped table-hover" data-count-fixed-columns="2">
                <thead>
                <tr>
                    <th style="border:solid;border-right:none;border-bottom:none">Name</th>
                    <th style="border:solid;border-bottom:none">SO #</th>
                    <th style="border:solid" rowspan=2>ESD</th>
                    <th style="border:solid" rowspan=2>Qty</th>
                    <th style="border:solid" rowspan=2>MO #</th>
                    <th style="border:solid" rowspan=2>MAC PO#</th>
                    <th style="border:solid" rowspan=2>Build Location</th>
                    <th style="border:solid" rowspan=2>Planner ESD</th>
                    <th style="border:solid" rowspan=2>Updated by</th>
                    <th style="border:solid" rowspan=2>Completion Date</th>
                    <th style="border:solid;text-align:center" colspan=10>Short #1</th>
                    <th style="border:solid;text-align:center" colspan=10>Short #2</th>
                    <th style="border:solid;text-align:center" colspan=10>Short #3</th>
                    <th style="border:solid;text-align:center" colspan=10>Short #4</th>
                </tr>
                <tr>
                    <th style="border:solid;border-right:none;border-top:none"></th>
                    <th style="border:solid;border-top:none"></th>
                    {# Short #1 #}
                    <th style="border:solid">Part Number</th>
                    <th style="border:solid">Painted Part</th>
                    <th style="border:solid">Date Needed</th>
                    <th style="border:solid">Vendor</th>
                    <th style="border:solid">Vendor PO#</th>
                    <th style="border:solid">Mod WO#</th>
                    <th style="border:solid">EDD</th>
                    <th style="border:solid">Mod Done Date</th>
                    <th style="border:solid">Received Date</th>
                    <th style="border:solid">Notes</th>
                    {# Short #2 #}
                    <th style="border:solid">Part Number</th>
                    <th style="border:solid">Painted Part</th>
                    <th style="border:solid">Date Needed</th>
                    <th style="border:solid">Vendor</th>
                    <th style="border:solid">Vendor PO#</th>
                    <th style="border:solid">Mod WO#</th>
                    <th style="border:solid">EDD</th>
                    <th style="border:solid">Mod Done Date</th>
                    <th style="border:solid">Received Date</th>
                    <th style="border:solid">Notes</th>
                    {# Short #3 #}
                    <th style="border:solid">Part Number</th>
                    <th style="border:solid">Painted Part</th>
                    <th style="border:solid">Date Needed</th>
                    <th style="border:solid">Vendor</th>
                    <th style="border:solid">Vendor PO#</th>
                    <th style="border:solid">Mod WO#</th>
                    <th style="border:solid">EDD</th>
                    <th style="border:solid">Mod Done Date</th>
                    <th style="border:solid">Received Date</th>
                    <th style="border:solid">Notes</th>
                    {# Short #4 #}
                    <th style="border:solid">Part Number</th>
                    <th style="border:solid">Painted Part</th>
                    <th style="border:solid">Date Needed</th>
                    <th style="border:solid">Vendor</th>
                    <th style="border:solid">Vendor PO#</th>
                    <th style="border:solid">Mod WO#</th>
                    <th style="border:solid">EDD</th>
                    <th style="border:solid">Mod Done Date</th>
                    <th style="border:solid">Received Date</th>
                    <th style="border:solid">Notes</th>
                </tr>            
                </thead>
                <tbody>
                    {% for job in jobs %}
                    <tr>
                        <td>{{ job.name }}</td>
                        <td>{{ job.salesOrder }}</td>   
                        <td>{{ job.estimatedShipDate|date('Y-m-d') }}</td>
                        <td>{{ job.quantity }}</td>
                        <td>{{ job.manufacturingOrder }}</td>
                        <td><a href="#" class="macPurchaseOrder" data-name="macPurchaseOrder" data-pk="{{job.kitting.id}}" data-url="{{ path('edit_job_mac_purchase_order', {'jobId': job.id}) }}">{{ job.macPurchaseOrder }}</a></td>
                        <td>{{ job.buildLocation.name }}</td>
                        <td>
                            {% if job.plannerEstimatedShipDate %}
                                {{ job.plannerEstimatedShipDate | date('Y-m-d') }}
                            {% else %}
                                TBD
                            {% endif %}
                        </td>
                        <td>{{job.kitting.updatedBy}}</td>
                        <td>{{job.kitting.completionDate | date('Y-m-d')}}</td>
                        {# Short #1 #}
                        {% if job.kitting.kittingShort1 is null or (job.kitting.kittingShort1 and (job.kitting.kittingShort1.modDoneDate or job.kitting.kittingShort1.receivedDate)) %}
                            <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td>
                        {% else %}
                            <td>{{ job.kitting.kittingShort1.partNumber | default("") }}</a></td>
                            <td>{{ job.kitting.kittingShort1.paintedPart | default("") }}</a></td>
                            <td>{{ job.kitting.kittingShort1 and job.kitting.kittingShort1.dateNeeded ? job.kitting.kittingShort1.dateNeeded | date('Y-m-d') : "" }}</td>
                            <td><a href="#" class="vendor1" data-name="vendor1" data-pk="{{job.kitting.id}}" data-url="{{ path('edit_kitting_short_vendor', {'jobId': job.id, 'shortId': (job.kitting.kittingShort1)?job.kitting.kittingShort1.id:0}) }}">{{ job.kitting.kittingShort1 ? job.kitting.kittingShort1.vendor : null }}</a></td>
                            <td><a href="#" class="vendorPoNumber1" data-name="vendorPoNumber1" data-pk="{{job.kitting.id}}" data-url="{{ path('edit_kitting_short_vendor_po_number', {'jobId': job.id, 'shortId': (job.kitting.kittingShort1)?job.kitting.kittingShort1.id:0}) }}">{{ job.kitting.kittingShort1 ? job.kitting.kittingShort1.vendorPoNumber : null }}</a></td>
                            <td><a href="#" class="modWo1" data-name="modWo1" data-pk="{{job.kitting.id}}" data-url="{{ path('edit_kitting_short_mod_wo', {'jobId': job.id, 'shortId': (job.kitting.kittingShort1)?job.kitting.kittingShort1.id:0}) }}">{{ job.kitting.kittingShort1 ? job.kitting.kittingShort1.modWo : null }}</a></td>
                            <td><a href="#" class="estimatedDeliveryDate1" data-name="estimatedDeliveryDate1" data-pk="{{job.kitting.id}}" data-url="{{ path('edit_kitting_short_estimated_delivery_date', {'shortId': (job.kitting.kittingShort1) ? job.kitting.kittingShort1.id : 0}) }}">{{ job.kitting.kittingShort1 and job.kitting.kittingShort1.estimatedDeliveryDate ? job.kitting.kittingShort1.estimatedDeliveryDate | date('Y-m-d') : "" }}</a></td>
                            <td>{{ job.kitting.kittingShort1 and job.kitting.kittingShort1.modDoneDate ? job.kitting.kittingShort1.modDoneDate | date('Y-m-d') : "" }}</td>
                            <td>{{ job.kitting.kittingShort1 and job.kitting.kittingShort1.receivedDate ? job.kitting.kittingShort1.receivedDate | date('Y-m-d') : "" }}</td>
                            <td><a href="#" class="notes1" data-name="notes1" data-pk="{{job.kitting.id}}" data-url="{{ path('edit_kitting_short_notes', {'jobId': job.id, 'shortId': (job.kitting.kittingShort1)?job.kitting.kittingShort1.id:0}) }}">{{ job.kitting.kittingShort1 ? job.kitting.kittingShort1.notes : null }}</a></td>
                        {% endif %}
                        {# Short #2 #}
                        {% if job.kitting.kittingShort2 is null or (job.kitting.kittingShort2 and (job.kitting.kittingShort2.modDoneDate or job.kitting.kittingShort2.receivedDate)) %}
                            <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td>
                        {% else %}
                            <td>{{ job.kitting.kittingShort2.partNumber | default("") }}</a></td>
                            <td>{{ job.kitting.kittingShort2.paintedPart | default("") }}</a></td>
                            <td>{{ job.kitting.kittingShort2 and job.kitting.kittingShort2.dateNeeded ? job.kitting.kittingShort2.dateNeeded | date('Y-m-d') : "" }}</td>
                            <td><a href="#" class="vendor2" data-name="vendor2" data-pk="{{job.kitting.id}}" data-url="{{ path('edit_kitting_short_vendor', {'jobId': job.id, 'shortId': (job.kitting.kittingShort2)?job.kitting.kittingShort2.id:0}) }}">{{ job.kitting.kittingShort2 ? job.kitting.kittingShort2.vendor : null }}</a></td>
                            <td><a href="#" class="vendorPoNumber2" data-name="vendorPoNumber2" data-pk="{{job.kitting.id}}" data-url="{{ path('edit_kitting_short_vendor_po_number', {'jobId': job.id, 'shortId': (job.kitting.kittingShort2)?job.kitting.kittingShort2.id:0}) }}">{{ job.kitting.kittingShort2 ? job.kitting.kittingShort2.vendorPoNumber : null }}</a></td>
                            <td><a href="#" class="modWo2" data-name="modWo2" data-pk="{{job.kitting.id}}" data-url="{{ path('edit_kitting_short_mod_wo', {'jobId': job.id, 'shortId': (job.kitting.kittingShort2)?job.kitting.kittingShort2.id:0}) }}">{{ job.kitting.kittingShort2 ? job.kitting.kittingShort2.modWo : null }}</a></td>
                            <td><a href="#" class="estimatedDeliveryDate2" data-name="estimatedDeliveryDate2" data-pk="{{job.kitting.id}}" data-url="{{ path('edit_kitting_short_estimated_delivery_date', {'shortId': (job.kitting.kittingShort2) ? job.kitting.kittingShort2.id : 0}) }}">{{ job.kitting.kittingShort2 and job.kitting.kittingShort2.estimatedDeliveryDate ? job.kitting.kittingShort2.estimatedDeliveryDate | date('Y-m-d') : "" }}</a></td>
                            <td>{{ job.kitting.kittingShort2 and job.kitting.kittingShort2.modDoneDate ? job.kitting.kittingShort2.modDoneDate | date('Y-m-d') : "" }}</td>
                            <td>{{ job.kitting.kittingShort2 and job.kitting.kittingShort2.receivedDate ? job.kitting.kittingShort2.receivedDate | date('Y-m-d') : "" }}</td>
                            <td><a href="#" class="notes2" data-name="notes2" data-pk="{{job.kitting.id}}" data-url="{{ path('edit_kitting_short_notes', {'jobId': job.id, 'shortId': (job.kitting.kittingShort2)?job.kitting.kittingShort2.id:0}) }}">{{ job.kitting.kittingShort2 ? job.kitting.kittingShort2.notes : null }}</a></td>
                        {% endif %}
                        {# Short #3 #}
                        {% if job.kitting.kittingShort3 is null or (job.kitting.kittingShort3 and (job.kitting.kittingShort3.modDoneDate or job.kitting.kittingShort3.receivedDate)) %}
                            <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td>
                        {% else %}
                            <td>{{ job.kitting.kittingShort3.partNumber | default("") }}</a></td>
                            <td>{{ job.kitting.kittingShort3.paintedPart | default("") }}</a></td>
                            <td>{{ job.kitting.kittingShort3 and job.kitting.kittingShort3.dateNeeded ? job.kitting.kittingShort3.dateNeeded | date('Y-m-d') : "" }}</td>
                            <td><a href="#" class="vendor3" data-name="vendor3" data-pk="{{job.kitting.id}}" data-url="{{ path('edit_kitting_short_vendor', {'jobId': job.id, 'shortId': (job.kitting.kittingShort3)?job.kitting.kittingShort3.id:0}) }}">{{ job.kitting.kittingShort3 ? job.kitting.kittingShort3.vendor : null }}</a></td>
                            <td><a href="#" class="vendorPoNumber3" data-name="vendorPoNumber3" data-pk="{{job.kitting.id}}" data-url="{{ path('edit_kitting_short_vendor_po_number', {'jobId': job.id, 'shortId': (job.kitting.kittingShort3)?job.kitting.kittingShort3.id:0}) }}">{{ job.kitting.kittingShort3 ? job.kitting.kittingShort3.vendorPoNumber : null }}</a></td>
                            <td><a href="#" class="modWo3" data-name="modWo3" data-pk="{{job.kitting.id}}" data-url="{{ path('edit_kitting_short_mod_wo', {'jobId': job.id, 'shortId': (job.kitting.kittingShort3)?job.kitting.kittingShort3.id:0}) }}">{{ job.kitting.kittingShort3 ? job.kitting.kittingShort3.modWo : null }}</a></td>
                            <td><a href="#" class="estimatedDeliveryDate3" data-name="estimatedDeliveryDate3" data-pk="{{job.kitting.id}}" data-url="{{ path('edit_kitting_short_estimated_delivery_date', {'shortId': (job.kitting.kittingShort3) ? job.kitting.kittingShort3.id : 0}) }}">{{ job.kitting.kittingShort3 and job.kitting.kittingShort3.estimatedDeliveryDate ? job.kitting.kittingShort3.estimatedDeliveryDate | date('Y-m-d') : "" }}</a></td>
                            <td>{{ job.kitting.kittingShort3 and job.kitting.kittingShort3.modDoneDate ? job.kitting.kittingShort3.modDoneDate | date('Y-m-d') : "" }}</td>
                            <td>{{ job.kitting.kittingShort3 and job.kitting.kittingShort3.receivedDate ? job.kitting.kittingShort3.receivedDate | date('Y-m-d') : "" }}</td>
                            <td><a href="#" class="notes3" data-name="notes3" data-pk="{{job.kitting.id}}" data-url="{{ path('edit_kitting_short_notes', {'jobId': job.id, 'shortId': (job.kitting.kittingShort3)?job.kitting.kittingShort3.id:0}) }}">{{ job.kitting.kittingShort3 ? job.kitting.kittingShort3.notes : null }}</a></td>
                        {% endif %}
                        {# Short #4 #}
                        {% if job.kitting.kittingShort4 is null or (job.kitting.kittingShort4 and (job.kitting.kittingShort4.modDoneDate or job.kitting.kittingShort4.receivedDate)) %}
                            <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td>
                        {% else %}
                            <td>{{ job.kitting.kittingShort4.partNumber | default("") }}</a></td>
                            <td>{{ job.kitting.kittingShort4.paintedPart | default("") }}</a></td>
                            <td>{{ job.kitting.kittingShort4 and job.kitting.kittingShort4.dateNeeded ? job.kitting.kittingShort4.dateNeeded | date('Y-m-d') : "" }}</td>
                            <td><a href="#" class="vendor4" data-name="vendor4" data-pk="{{job.kitting.id}}" data-url="{{ path('edit_kitting_short_vendor', {'jobId': job.id, 'shortId': (job.kitting.kittingShort4)?job.kitting.kittingShort4.id:0}) }}">{{ job.kitting.kittingShort4 ? job.kitting.kittingShort4.vendor : null }}</a></td>
                            <td><a href="#" class="vendorPoNumber4" data-name="vendorPoNumber4" data-pk="{{job.kitting.id}}" data-url="{{ path('edit_kitting_short_vendor_po_number', {'jobId': job.id, 'shortId': (job.kitting.kittingShort4)?job.kitting.kittingShort4.id:0}) }}">{{ job.kitting.kittingShort4 ? job.kitting.kittingShort4.vendorPoNumber : null }}</a></td>
                            <td><a href="#" class="modWo4" data-name="modWo4" data-pk="{{job.kitting.id}}" data-url="{{ path('edit_kitting_short_mod_wo', {'jobId': job.id, 'shortId': (job.kitting.kittingShort4)?job.kitting.kittingShort4.id:0}) }}">{{ job.kitting.kittingShort4 ? job.kitting.kittingShort4.modWo : null }}</a></td>
                            <td><a href="#" class="estimatedDeliveryDate4" data-name="estimatedDeliveryDate4" data-pk="{{job.kitting.id}}" data-url="{{ path('edit_kitting_short_estimated_delivery_date', {'shortId': (job.kitting.kittingShort4) ? job.kitting.kittingShort4.id : 0}) }}">{{ job.kitting.kittingShort4 and job.kitting.kittingShort4.estimatedDeliveryDate ? job.kitting.kittingShort4.estimatedDeliveryDate | date('Y-m-d') : "" }}</a></td>
                            <td>{{ job.kitting.kittingShort4 and job.kitting.kittingShort4.modDoneDate ? job.kitting.kittingShort4.modDoneDate | date('Y-m-d') : "" }}</td>
                            <td>{{ job.kitting.kittingShort4 and job.kitting.kittingShort4.receivedDate ? job.kitting.kittingShort4.receivedDate | date('Y-m-d') : "" }}</td>
                            <td><a href="#" class="notes4" data-name="notes4" data-pk="{{job.kitting.id}}" data-url="{{ path('edit_kitting_short_notes', {'jobId': job.id, 'shortId': (job.kitting.kittingShort4)?job.kitting.kittingShort4.id:0}) }}">{{ job.kitting.kittingShort4 ? job.kitting.kittingShort4.notes : null }}</a></td>
                        {% endif %}
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
{% endblock %}

{% block javascripts %}
    <script>

    $(document).ready(function() {
        app_handle_listing_horizontal_scroll($('#table-listing'));

        //toggle `popup` / `inline` mode
        $.fn.editable.defaults.mode = 'popup';

        $('.macPurchaseOrder').each(function(i, obj) {
            $(this).editable({
                type: 'text',
                url: obj.dataset.url,
                title: 'Enter MAC PO#',
                success: function(response, newValue) {
                    if (response.status == 'error') return response.msg; //msg will be shown in editable form
                }
            });
        });

        $('.estimatedDeliveryDate1').each(function(i, obj) {
            $(this).editable({
                type: 'date',
                placement: 'left',
                url: obj.dataset.url,
                title: 'Select Estimated Delivery Date',
                success: function(response, newValue) {
                    if (response.status == 'error') return response.msg; //msg will be shown in editable form
                }
            });
        });

        $('.estimatedDeliveryDate2').each(function(i, obj) {
            $(this).editable({
                type: 'date',
                placement: 'left',
                url: obj.dataset.url,
                title: 'Select Estimated Delivery Date',
                success: function(response, newValue) {
                    if (response.status == 'error') return response.msg; //msg will be shown in editable form
                }
            });
        });

        $('.estimatedDeliveryDate3').each(function(i, obj) {
            $(this).editable({
                type: 'date',
                placement: 'left',
                url: obj.dataset.url,
                title: 'Select Estimated Delivery Date',
                success: function(response, newValue) {
                    if (response.status == 'error') return response.msg; //msg will be shown in editable form
                }
            });
        });

        $('.estimatedDeliveryDate4').each(function(i, obj) {
            $(this).editable({
                type: 'date',
                placement: 'left',
                url: obj.dataset.url,
                title: 'Select Estimated Delivery Date',
                success: function(response, newValue) {
                    if (response.status == 'error') return response.msg; //msg will be shown in editable form
                }
            });
        });

        $('.notes1').each(function(i, obj) {
            $(this).editable({
                type: 'text',
                url: obj.dataset.url,
                title: 'Enter notes #1',
                success: function(response, newValue) {
                    if (response.status == 'error') return response.msg; //msg will be shown in editable form
                }
            });
        });

        $('.notes2').each(function(i, obj) {
            $(this).editable({
                type: 'text',
                url: obj.dataset.url,
                title: 'Enter notes #2',
                success: function(response, newValue) {
                    if (response.status == 'error') return response.msg; //msg will be shown in editable form
                }
            });
        });

        $('.notes3').each(function(i, obj) {
            $(this).editable({
                type: 'text',
                url: obj.dataset.url,
                title: 'Enter notes #3',
                success: function(response, newValue) {
                    if (response.status == 'error') return response.msg; //msg will be shown in editable form
                }
            });
        });

        $('.notes4').each(function(i, obj) {
            $(this).editable({
                type: 'text',
                url: obj.dataset.url,
                title: 'Enter notes #4',
                success: function(response, newValue) {
                    if (response.status == 'error') return response.msg; //msg will be shown in editable form
                }
            });
        });

        $('.vendor1').each(function(i, obj) {
            $(this).editable({
                type: 'text',
                url: obj.dataset.url,
                title: 'Enter vendor #1',
                success: function(response, newValue) {
                    if (response.status == 'error') return response.msg; //msg will be shown in editable form
                }
            });
        });

        $('.vendor2').each(function(i, obj) {
            $(this).editable({
                type: 'text',
                url: obj.dataset.url,
                title: 'Enter vendor #2',
                success: function(response, newValue) {
                    if (response.status == 'error') return response.msg; //msg will be shown in editable form
                }
            });
        });

        $('.vendor3').each(function(i, obj) {
            $(this).editable({
                type: 'text',
                url: obj.dataset.url,
                title: 'Enter vendor #3',
                success: function(response, newValue) {
                    if (response.status == 'error') return response.msg; //msg will be shown in editable form
                }
            });
        });

        $('.vendor4').each(function(i, obj) {
            $(this).editable({
                type: 'text',
                url: obj.dataset.url,
                title: 'Enter vendor #4',
                success: function(response, newValue) {
                    if (response.status == 'error') return response.msg; //msg will be shown in editable form
                }
            });
        });
        
        $('.vendorPoNumber1').each(function(i, obj) {
            $(this).editable({
                type: 'text',
                url: obj.dataset.url,
                title: 'Enter vendor PO# 1',
                success: function(response, newValue) {
                    if (response.status == 'error') return response.msg; //msg will be shown in editable form
                }
            });
        });

        $('.vendorPoNumber2').each(function(i, obj) {
            $(this).editable({
                type: 'text',
                url: obj.dataset.url,
                title: 'Enter vendor PO# 2',
                success: function(response, newValue) {
                    if (response.status == 'error') return response.msg; //msg will be shown in editable form
                }
            });
        });

        $('.vendorPoNumber3').each(function(i, obj) {
            $(this).editable({
                type: 'text',
                url: obj.dataset.url,
                title: 'Enter vendor PO# 3',
                success: function(response, newValue) {
                    if (response.status == 'error') return response.msg; //msg will be shown in editable form
                }
            });
        });

        $('.vendorPoNumber4').each(function(i, obj) {
            $(this).editable({
                type: 'text',
                url: obj.dataset.url,
                title: 'Enter vendor PO# 4',
                success: function(response, newValue) {
                    if (response.status == 'error') return response.msg; //msg will be shown in editable form
                }
            });
        });

        $('.modWo1').each(function(i, obj) {
            $(this).editable({
                type: 'text',
                url: obj.dataset.url,
                title: 'Enter Mod WO# 1',
                success: function(response, newValue) {
                    if (response.status == 'error') return response.msg; //msg will be shown in editable form
                }
            });
        });

        $('.modWo2').each(function(i, obj) {
            $(this).editable({
                type: 'text',
                url: obj.dataset.url,
                title: 'Enter Mod WO# 2',
                success: function(response, newValue) {
                    if (response.status == 'error') return response.msg; //msg will be shown in editable form
                }
            });
        });

        $('.modWo3').each(function(i, obj) {
            $(this).editable({
                type: 'text',
                url: obj.dataset.url,
                title: 'Enter Mod WO# 3',
                success: function(response, newValue) {
                    if (response.status == 'error') return response.msg; //msg will be shown in editable form
                }
            });
        });

        $('.modWo4').each(function(i, obj) {
            $(this).editable({
                type: 'text',
                url: obj.dataset.url,
                title: 'Enter Mod WO# 4',
                success: function(response, newValue) {
                    if (response.status == 'error') return response.msg; //msg will be shown in editable form
                }
            });
        });

    });
    </script>
{% endblock %}